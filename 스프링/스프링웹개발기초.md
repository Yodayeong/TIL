## 스프링 웹 개발 기초

- 정적 컨텐츠
  - 서버에서 하는 것 없이, 파일을 그대로 웹 브라우저에 내려주는 방식
- MVC와 템플릿 엔진
  - 서버에서 조금 변형을 해서 내려주는 방식
- API
  - json 형식으로 클라이언트에게 data를 전달하는 방식

<br>

#### 정적 컨텐츠

- 스프링 부트 정적 컨텐츠 기능 (resources:static)

  `resources/static/hello-static.html`

  ```html
  <!DOCTYPE html>
  <html>
  <head>
      <title>static content</title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  </head>
  <body>
      정적 컨텐츠 입니다.
  </body>
  </html>
  ```

  => localhost:8080/hello-static.html 접속

- 작동원리

  - localhost를 통해 접속하면, 내장 톰켓 서버가 hello-static 관련 컨트롤러를 먼저 찾음(컨트롤러가 우선순위를 가짐)
  - 해당 컨트롤러가 없으므로, resources:static 에서 hello-static 관련 html을 찾음
  - 해당 html이 있으므로, 이를 반환

<br>

#### MVC와 템플릿 엔진

- MVC : Model, View, Controller

<br>

- `controller/HelloController`

  ```java
  @GetMapping("hello-mvc")
  public String helloMvc(@RequestParam(name = "name", required = false) String name, Model model) {
      //웹에서 입력받음. required 기본값이 true이고, required = false를 하면 입력값이 없어도 작동함
      model.addAttribute("name", name); //key값이 name이고, value가 name
      return "hello-template";
  }
  ```
  
- `templates/hello-template.html`

  ```html
  <html xmlns:th="http://www.thymeleaf.org">
  <body>
      <p th:text="'hello ' + ${name}">hello! empty</p>
  </body>
  </html>
  ```

  => `localhost:8080/hello-mvc?name=spring!` 접속

- 작동원리
  - 웹 브라우저에서 hello-mvc localhost에 접속하면,
  - 내장 톰켓 서버를 통해 스프링 컨테이너의 helloController를 실행
  - helloController를 통해 hello-template을 return 하는데, 이때 model에는 (name:spring)이 들어가 있음
  - viewResolver가 templates에서 hello-template.html을 찾아서, thymeleaf 템플릿 엔진을 처리하고,
  - 변환을 한 html을 웹 브라우저에 넘겨줌 
  - *정적 컨텐츠에서는 변환 과정이 일어나지 않음

<br>

#### API

- `controller/HelloController`

  => 데이터만 고대로 출력

  ```java
  @GetMapping("hello-string")
  @ResponseBody //http 통신부에서 header부와 body부 중에서 body부에 이 내용을 넣어주겠다.
  public String helloString(@RequestParam("name") String name) {
      return "hello " + name; //view 같은 것이 없고 이 문자가 고대로 내려감. data만 전달.
  }
  ```

  => 데이터 객체만 json 형식으로 반환

  (json: key-value로 이루어진 데이터 구조)

  ```json
  @GetMapping("hello-api")
  @ResponseBody
  public Hello helloApi(@RequestParam("name") String name) {
      Hello hello = new Hello();
      hello.setName(name);
      return hello;
  }
  
  static class Hello {
      private String name; //private이라 외부에서 못꺼냄. getter와 setter 메서드로 접근함.
  
      public String getName() {
          return name;
      }
  
      public void setName(String name) {
          this.name = name;
      }
  }
  ```

- 작동원리

  - 웹 브라우저에서 hello-api localhost에 접속하면,
  - 톰켓 내장 서버에서 요청이 왔다고 스프링에 던지면,
  - 스프링은 helloController 안에 hello-api를 발견.
  - @ResponseBody가 없으면 viewResolver한테 넘겨서 템플릿을 찾음. 하지만 @ResponseBody가 붙어 있으므로, http에 대한 응답으로 데이터를 그대로 넘김.
  - 그런데, 문자가 아니라 Hello라는 객체를 반환함. 
  - 문자가 반환되면 HttpMessageConverter가 StringConverter를 작동시키지만, 객체를 반환하면, 기본 default 값으로 JsonConverter를 작동시켜, 데이터를 json 형식으로 변환함. (json 말고 다른 형식으로 보낼수도 있음)
  - 이 변환된 데이터를 웹 브라우저로 넘겨줌.